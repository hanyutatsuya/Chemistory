F8åüçı

SELECT DISTINCT 
	KNO.KNSSEQ,
	ZBML_KNTNO_CNV(KNO.KNTNO,KNO.KNTKETFLG) AS KNTNO,
	KNO.KNSKISYMD,
	KNO.KNSGRP,
	KNO.SRIYMD
FROM (SELECT KEKKA.UTKYMD,KEKKA.IRINO,KEKKA.ZSSDINO,KEKKA.KNSGRP,KEKKA.KMKCD,IRAI.STSRCD AS ZRCD
		FROM KEKKA,IRAI
		WHERE KEKKA.KNSGRP = '0054'
		AND KEKKA.KNSFLG <> 'M'
		AND (KEKKA.KISYAKFLG = '2' OR KEKKA.YOBIFLG01 = '2')
		AND KEKKA.KNSKISYMD = '2021-05-12'
		AND KEKKA.UTKYMD = IRAI.UTKYMD
		AND KEKKA.IRINO = IRAI.IRINO
		AND KEKKA.ZSSDINO = IRAI.ZSSDINO
		AND KEKKA.KNSGRP = IRAI.KNSGRP
		AND KEKKA.KMKCD = IRAI.KMKCD
		AND IRAI.ODRSSFLG = '2'
		AND IRAI.HHKJKFLG <> 'R'
		AND KNSFLG IN ('A','R','T')
		AND NOT EXISTS 
			(SELECT * 
				FROM KEKKA K INNER JOIN IRAI AS I 
								ON I.KNSSU = 1 
								AND K.KNSSU = 1 
								AND K.KNSFLG = 'A' 
								AND (K.KISYAKFLG = '2' OR K.YOBIFLG01 = '2') 
								AND K.UTKYMD = I.UTKYMD 
								AND K.IRINO = I.IRINO 
								AND K.ZSSDINO = I.ZSSDINO 
								AND K.KNSGRP = I.KNSGRP 
								AND K.KMKCD = I.KMKCD 
								AND K.UTKYMD = KEKKA.UTKYMD 
								AND K.IRINO = KEKKA.IRINO 
								AND K.ZSSDINO = KEKKA.ZSSDINO 
								AND K.KNSGRP = KEKKA.KNSGRP 
								AND K.KMKCD = KEKKA.KMKCD)
		UNION 
		SELECT IRI.UTKYMD,IRI.IRINO,IRI.ZSSDINO,IRI.KNSGRP,IRI.KMKCD,IRI.STSRCD AS ZRCD 
		FROM IRAI IRI INNER JOIN KEKKA AS KEK 
			ON IRI.UTKYMD = KEK.UTKYMD 
			AND IRI.IRINO = KEK.IRINO 
			AND IRI.ZSSDINO = KEK.ZSSDINO 
			AND IRI.KNSGRP = KEK.KNSGRP 
			AND IRI.KMKCD = KEK.KMKCD 
			AND KEK.KNSFLG IN ('A','R','T') 
			AND KEK.KNSKISYMD = '2021-05-12' 
			WHERE IRI.KNSGRP = '0054' 
			AND IRI.ODRSSFLG = '2' 
			AND IRI.KSKTKBN IN ('K','T') 
			AND IRI.HHKJKFLG <> 'R' )
	 UNI,
	 (SELECT KNSKISYMD,UTKYMD,SRIYMD,IRINO,KNTNO,ZSSDINO,KNSGRP,KMKCD,KNTKETFLG,MIN(KNSSEQ) AS KNSSEQ 
		 		FROM KENORDER 
		 		WHERE KNSKISYMD = '2021-05-12' 
		 		AND KNSSEQ BETWEEN 0 AND 9999999 
		 		AND KSKTKBN IN ('A', 'S') 
		 		GROUP BY KNSKISYMD,UTKYMD,IRINO,SRIYMD,KNTNO,ZSSDINO,KNSGRP,KMKCD,KNTKETFLG)
	KNO
	WHERE UNI.UTKYMD = KNO.UTKYMD 
	AND UNI.IRINO = KNO.IRINO 
	AND UNI.ZSSDINO = KNO.ZSSDINO 
	AND UNI.KNSGRP = KNO.KNSGRP 
	AND UNI.KMKCD = KNO.KMKCD 
	ORDER BY KNSSEQ FOR READ ONLY 

åüëÃNOëIëéû
SELECT 
	RTRIM(KMKRS) as KMKRS, 
	KMKMST.KNSGRP, 
	KMKMST.KMKCD, 
	KSNKMKFLG, 
	SUM(CASE KEKKA.KNSFLG WHEN 'E' THEN 1 ELSE 0 END) AS HKZMCNT 
	FROM KMKMST, KENORDER, KEKKA 
	WHERE KENORDER.KNTNO = '00304450104  ' 
	AND KENORDER.KNSKISYMD = '2021-05-12' 
	AND KENORDER.SRIYMD = '2021-05-12' 
	AND KENORDER.KNSGRP = '0054' 
	AND KMKMST.KMKCD = KENORDER.KMKCD 
	AND KMKMST.KNSGRP = KENORDER.KNSGRP 
	AND KMKMST.KAIYMD <= '2021-05-12' 
	AND KMKMST.HAIYMD >= '2021-05-12' 
	AND KENORDER.UTKYMD = KEKKA.UTKYMD 
	AND KENORDER.IRINO = KEKKA.IRINO 
	AND KENORDER.KMKCD = KEKKA.KMKCD 
	GROUP BY KMKRS, KMKMST.KNSGRP, KMKMST.KMKCD, HYJIJN, KSNKMKFLG  
	ORDER BY HYJIJN  FOR READ ONLY

SELECT 
	A.KNSSU,
	A.KKAYSNFLG,
	A.KNSKISYMD AS KNSKISYMD_KEY,
	A.SRIYMD AS SRIYMD_KEY,
	A.KNTNO AS KNTNO_KEY,
	A.KNSGRP AS KNSGRP_KEY,
	A.KMKCD AS KMKCD_KEY,
	A.KNSSU AS KNSSU_KEY,
	A.KNSSUEDA AS KNSSUEDA_KEY,
	A.KNSFLG,
	RTRIM(LTRIM(A.HJKKA)) AS HJKKA,
	A.KKAHSKCD,A.KKACMT1,
	A.KKACMT2,
	A.JISKSBR,
	A.RENJICFLG,
	A.SOUKN1FLG,
	A.KANRENFLG,
	A.BUNKKUFLG,
	A.KESSEIFLG,
	A.RIREKIFLG,
	A.SYOUGOFLG,
	A.KEISANFLG,
	A.PER100FLG,
	A.TOUSEKFLG,
	A.KISYAKFLG,
	A.KOUSEIFLG,
	A.SYOUNGFLG,
	A.SOUKN2FLG,
	A.FUKAPTFLG,
	IRI.YTIKSBR AS YTIKSBR,
	'' AS YTIKSBR2,
	COALESCE(A.BSKKBN,'    ')||COALESCE(A.BSKLNE,'      ')||CHAR(A.CTRLNO) AS CTRLNO,
	A.SSTCD 
	FROM KEKKA A LEFT OUTER JOIN IRAI IRI 
		ON A.IRINO = IRI.IRINO 
		AND A.KMKCD = IRI.KMKCD 
		AND A.UTKYMD = IRI.UTKYMD 
		AND A.ZSSDINO = IRI.ZSSDINO 
		AND A.KNSGRP	= IRI.KNSGRP 
	WHERE A.KNTNO = '00304450104  ' 
	AND A.KMKCD = '0000401' 
	AND A.KNSKISYMD = '2021-05-12' 
	AND A.SRIYMD = '2021-05-12' 
	AND A.KNSGRP = '0054' 
	AND A.KNSSU <> 0 
	AND A.KNSSUEDA < 9000 
	ORDER BY KNSSU 
	FOR READ ONLY

SELECT 
	A.KKAYSNFLG, 
	A.KNSKISYMD AS KNSKISYMD_KEY, 
	A.SRIYMD AS SRIYMD_KEY, 
	A.KNTNO AS KNTNO_KEY, 
	A.KNSGRP AS KNSGRP_KEY, 
	A.KMKCD AS KMKCD_KEY, 
	A.KNSSU AS KNSSU_KEY, 
	A.KNSSUEDA AS KNSSUEDA_KEY, 
	A.KNSFLG, 
	RTRIM(LTRIM(A.HJKKA)) as HJKKA, 
	A.KKAHSKCD, 
	A.KKACMT1, 
	A.KKACMT2, 
	A.JISKSBR, 
	A.SSTCD 
	FROM KEKKA A 
	WHERE A.KNTNO = '00304450104  ' 
	AND A.KMKCD = '0000401' 
	AND A.KNSKISYMD = '2021-05-12' 
	AND A.KNSGRP = '0054' 
	AND A.KNSSU = 0 
	AND A.KNSSUEDA< 9000 
	ORDER BY KNSSU 
	FOR READ ONLY

